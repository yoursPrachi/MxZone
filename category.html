<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MXZone | Category</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <!-- App Bar -->
  <header class="app-bar">
    <a href="/" class="back">â† Home</a>
    <h1 id="categoryTitle">Category</h1>
  </header>

  <!-- Search Bar -->
  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="ğŸ” Search movies..." />
  </div>

  <!-- Movie Grid -->
  <main class="container">
    <div id="grid" class="grid"></div>
  </main>

  <footer class="footer">
    <p>Â© 2025 MXZone | Powered by Firebase + Cloudinary</p>
  </footer>

  <!-- Firebase + UI -->
  <script type="module">
    import { fetchMovies } from './lib/data.js';
    import { renderGrid } from './lib/ui.js';

    const params = new URLSearchParams(window.location.search);
    const category = params.get("cat") || "trending";

    document.getElementById("categoryTitle").textContent =
      category.charAt(0).toUpperCase() + category.slice(1);

    let allMovies = [];
    const grid = document.getElementById('grid');
    const searchInput = document.getElementById('searchInput');

    fetchMovies().then(movies => {
      allMovies = movies;
      renderCategory();
    });

    function renderCategory() {
      const q = searchInput.value.toLowerCase();
      const filtered = allMovies
        .filter(m => m.category === category)
        .filter(m => m.title.toLowerCase().includes(q) || m.description.toLowerCase().includes(q));
      renderGrid(grid, filtered);
    }

    searchInput.addEventListener("input", renderCategory);
  </script>
</body>
</html>
